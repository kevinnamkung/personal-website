---
const items = [
  {
    title: "Experience",
    content: [
      {
        name: "Software Engineer - Capital One",
        url: "https://capitalone.com",
        image: "/images/cap1swe.png"
      },
      {
        name: "Software Engineer Intern - General Atomics",
        url: "https://ga.com",
        image: "/images/cap1intern.png"
      }
    ],
  },
  {
    title: "Projects",
    content: [
      {
        name: "Personal Website",
        url: "https://example.com",
        image: "/images/cap1swe.png"
      },
      {
        name: "Discord Bot - Viola",
        url: "https://github.com",
        image: "/images/cap1swe.png"
      }
    ],
  },
];

const defaultImage = items[0].content[0].image;
---

<style>
  
  .container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 60px;
    max-width: 800px;
    margin-left: 20vw;
    margin-top: 100px;
  }

  .dropdown {
    width: 100%;
    max-width: 400px;
    margin-right: -20px;
  }

  .dropdown-item {
    padding: 10px;
    cursor: pointer;
    background-color: #E6E6E6;
    transition: background 0.2s;
    font-family: 'Karla', sans-serif;
    font-weight: normal;
    border-bottom: 1px solid #ccc;
  }

  .dropdown-item:hover {
    background-color: #e0e0e0;
  }

  .dropdown-content {
    display: none;
    padding: 5px;
    background: #E6E6E6;
    margin-top: 10px; /* Default margin between dropdown item and content */
    transition: margin-top 0.2s; /* Smooth transition for margin change */
  }

  .dropdown-content.active {
    display: block;
    margin-top: 0; /* Less space between dropdown item and content when active */
  }

  .dropdown-content ul {
    list-style: none;
    padding-left: 1;
    margin: 0;
  }

   /* Style each item with padding, border, and background */
   .dropdown-content li {
    margin-bottom: 10px;
    background-color: #E6E6E6;
    border-radius: 5px;
    transition: background 0.3s;
  }

  .dropdown-content li.active-item {
    background-color: #e0e0e0; 
  }

  .dropdown-content li:hover {
    background-color: #e0e0e0;
  }

  /* Add link styles */
  .dropdown-content a {
    text-decoration: none;
    color: #343434;
    font-size: clamp(1rem, 3vw, 1rem); /* Adjust subtitle size */
  }

  .dropdown-content a:hover {
    text-decoration: underline;
  }

  .image-container {
    max-width: 500px;
    max-height: 500px;
  }

  .image-container img {
    width: 170%;
    height: auto;
    border-radius: 0px;
  }

</style>

<section class="container">
  <!-- Dropdown Section -->
  <div class="dropdown">
    {items.map((item, index) => (
      <div>
        <div class="dropdown-item" id={`dropdown-toggle-${index}`}>
          {item.title}
        </div>
        <div class="dropdown-content" id={`dropdown-${index}`}>
          <ul>
            {item.content.map((entry, idx) => (
              <li>
                <a href={entry.url} target="_blank" data-image={entry.image}>{entry.name}</a>
              </li>
            ))}
          </ul>
        </div>
      </div>
    ))}
  </div>

  <!-- Image Display -->
  <div class="image-container">
    <img id="display-image" src={defaultImage} alt="Experience Image">
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dropdownItems = document.querySelectorAll('.dropdown-item');
    const imageContainer = document.getElementById('display-image');
    const dropdownLinks = document.querySelectorAll('.dropdown-content a');

    // Set the default active image
    const defaultActiveItem = document.querySelector('.dropdown-content a[data-image]');
    if (defaultActiveItem) {
      defaultActiveItem.parentElement.classList.add('active-item'); // Highlight first item
    }

    // Ensure the first dropdown (Experience) is expanded
    const firstDropdown = document.getElementById('dropdown-0');
    if (firstDropdown) {
      firstDropdown.classList.add('active');
    }

    // dropdown
    dropdownItems.forEach((item, index) => {
      item.addEventListener('click', function() {
        const content = document.getElementById(`dropdown-${index}`);
        if (content) {
          content.classList.toggle('active');
        }
      });
    });

    // Handle image and highlight the corresponding dropdown item
    dropdownLinks.forEach((link) => {
      link.addEventListener('click', (event) => {
        event.preventDefault(); // Prevent default link behavior

        // Update image
        const target = event.currentTarget;
        const imageSrc = target.getAttribute('data-image');
        if (imageContainer) {
          imageContainer.src = imageSrc;
        }

        // Remove active-item class from all list items
        document.querySelectorAll('.dropdown-content li').forEach((li) => {
          li.classList.remove('active-item');
        });

        // Highlight the clicked item
        target.parentElement.classList.add('active-item');
      });
    });
  });
</script>
